---
title: "Code"
editor: visual
---


```{r}
#| fig-width: 9
#| fig-height: 5.5
#| fig-dpi: 300
#| out-width: 100%
#| fig-align: center

library(ggplot2)
library(dplyr)
library(forcats)

Eligibility <- data.frame(
  Category = c("Meets All Criteria","Multiple Disqualifiers","Medical/Physical",
               "Overweight","Mental Health","Drug Abuse",
               "Conduct","Dependents","Aptitude"),
  Percent  = c(23, 44, 7, 11, 4, 8, 1, 1, 1)
)

lev_order <- c("Meets All Criteria","Dependents","Conduct","Aptitude",
               "Mental Health","Medical/Physical","Drug Abuse",
               "Overweight","Multiple Disqualifiers")

Eligibility <- Eligibility %>%
  mutate(
    Category = factor(Category, levels = lev_order),
    Group = case_when(
      Category == "Meets All Criteria" ~ "Eligible",
      TRUE ~ "Ineligible"))

ggplot(Eligibility, aes(x = Category, y = Percent, fill = Group)) +
  geom_col(width = 0.8) +
  coord_flip() +
  geom_text(aes(label = paste0(Percent, "%")), hjust = -0.1, size = 4) +
  annotate("segment", x = 1.5, xend = 1.5, y = 0, yend = 50,
           linewidth = 0.7, color = "#4B0000") +
  labs(
    title = "Military Eligibility Among U.S. Youth (2020)",
    x = "Eligibility Status Reasoning",
    y = "Percentage of Youth (ages 17-24)",
    caption = "Source: JAMRS, 2020 Youth Report [2]",
    fill = "Eligibility Status"
  ) +
  scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0, 0))) +
  scale_fill_manual(
    values = c(
      "Ineligible" = "#9a031e",
      "Eligible" = "#2CA58D"
    ),
    breaks = c("Ineligible", "Eligible") 
  ) +
  theme_minimal(base_size = 8) +
  theme(
    plot.title = element_text(size = 18, face = "bold", color = "#4B0000", hjust = 0.3),
    axis.title.x = element_text(size = 14, color = "#4B0000", margin = margin(t = 10)),
    axis.title.y = element_text(size = 14, color = "#4B0000", margin = margin(r = 10)),
    axis.text.x = element_text(size = 10, color = "#4B0000"),
    axis.text.y = element_text(size = 10, color = "#4B0000"),
    panel.grid.major.y = element_blank(),
    plot.caption = element_text(size = 10, hjust = 0, color = "#4B0000", margin = margin(t = 8, l = 2)),
    plot.margin = margin(10, 20, 10, 20),
    legend.position = "right",
    legend.direction = "vertical",
    legend.title = element_text(size = 10, face = "bold", color = "#4B0000"),
    legend.text = element_text(size = 10, color = "#4B0000")
  )

```